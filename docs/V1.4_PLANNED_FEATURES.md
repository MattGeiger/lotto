# v1.4.0 Planned Features

**Status:** All Phases Complete  
**Target branch:** `dev`  
**Scope:** UI/UX enhancements only (no state model changes)  
**Last updated:** February 12, 2026

---

## Summary

Version 1.4.0 focuses on two major UI upgrades:

1. Add a high-contrast accessibility theme option (`Hi-viz`) that sits alongside the current light/dark/system choices.
2. Add motion enhancements using Animate UI (components + icons) to improve perceived responsiveness and touch feedback.

Both features must preserve existing safety-critical UX behavior in admin/public flows and must not reduce clarity for vulnerable users.

---

## Alignment With Existing Patterns

- **WITHIN existing patterns:** Theme is still token-driven (`src/app/globals.css`) and uses shadcn/Next Themes architecture already present in the app.
- **WITHIN existing patterns:** Motion additions are component-level and can be introduced progressively in the same TSX + shadcn workflow.
- **Constraint:** Motion must remain subordinate to legibility, queue clarity, and safety requirements from `docs/UX_REQUIREMENTS.md`.

---

## Feature 1: High-Contrast Theme (`Hi-viz`)

### UX Intent

- Improve legibility for visually impaired users with stronger contrast and clearer boundaries.
- Keep existing user mental model intact: same switcher, same placement, same quick access.
- Maintain default behavior: app follows device preference unless user chooses otherwise.

### Theme Menu (Planned)

- `(lucide:sun) Light`
- `(lucide:moon) Dark`
- `(lucide:sun-moon) System`
- `(lucide:view) Hi-viz`

### Design Source

- Candidate token set lives in: `docs/HC_UI.md` (generated via TweakCN and already formatted for Tailwind v4 variable mapping).

### Architecture Decision

To support `Hi-viz` cleanly without breaking `system` behavior, treat theme as two concerns:

1. **Color scheme:** `light | dark | system`
2. **Contrast mode:** `default | hi-viz`

This avoids overloading a single theme string and lets Hi-viz still honor dark/light device mode when desired.

### Planned Implementation Tasks

1. Extend theme state/provider to include contrast mode persistence.
2. Update theme switcher UI to render icon+label items and the new `Hi-viz` action.
3. Add high-contrast token namespace in `src/app/globals.css`.
4. Map `docs/HC_UI.md` values into `:root`/`.dark` overrides scoped by a class (example: `.hi-viz`).
5. Ensure Sonner/toast colors follow high-contrast tokens.
6. Validate logo, badge, card, input, and control legibility in all combinations.

### Planned File Touchpoints

- `src/components/theme-provider.tsx`
- `src/components/theme-switcher.tsx`
- `src/app/globals.css`
- `src/components/ui/sonner.tsx`
- `src/app/page.tsx`
- `src/app/admin/page.tsx`

### Accessibility Requirements

- WCAG AA minimum contrast for normal text and interactive controls.
- Focus ring contrast must remain strong in all theme states.
- Theme choice must be keyboard reachable and screen-reader understandable.
- No hidden state changes; current selection must be visually obvious.

### Acceptance Criteria (Feature 1)

- Theme menu shows four items with icons and labels.
- `System` follows OS dark/light preference by default.
- `Hi-viz` can be enabled from the same menu and persists across refresh.
- Public display, admin, and login/staff pages remain readable and consistent.
- No regressions in existing dark/light behavior.

---

## Feature 2: Motion Enhancements (Animate UI)

### UX Intent

- Improve perceived fluidity and tactile feedback, especially on touch screens.
- Use meaningful motion to support state understanding (not decoration-heavy animation).
- Keep interactions fast and understandable in high-stress staff workflows.

### Motion Principles

- Motion clarifies intent: entry, hover/tap feedback, state transition.
- Motion never obscures critical information (ticket numbers, now-serving state, warnings).
- Motion respects user preferences (`prefers-reduced-motion`).
- Fast timings by default; avoid long or looping animation in operational controls.

### Animate UI Integration Notes

- Animate UI follows the shadcn distribution model (`shadcn add ...`) and installs components into project code.
- Animated icons are marked **beta** in Animate UI docs; wrap rollout with guardrails and selective adoption.
- Primary docs:
  - https://animate-ui.com/docs
  - https://animate-ui.com/docs/icons
  - https://animate-ui.com/docs/icons/get-started

### Planned Motion Targets

1. Header controls: theme switcher, language switcher, search action.
2. Cards/dialogs: enter/exit transitions for non-critical layout changes.
3. Feedback states: action pending/success/error micro-transitions.
4. Lucide icon replacements where animated variants improve affordance.

### Non-Goals (v1.4.0)

- No full-page cinematic transitions.
- No animation that delays task completion.
- No motion that changes or obscures queue order/state interpretation.

### Planned Implementation Tasks

1. Introduce Animate UI primitives/icons in selected, high-value controls first.
2. Define shared motion tokens (duration/ease/distance) in CSS utilities.
3. Add reduced-motion fallbacks for all new animated elements.
4. Keep critical admin actions deterministic and immediate.
5. Tune mobile touch interactions for responsiveness.

### Planned File Touchpoints

- `src/components/theme-switcher.tsx`
- `src/components/language-switcher.tsx`
- `src/app/page.tsx`
- `src/app/admin/page.tsx`
- `src/components/ui/*` (selected components only)
- `src/app/globals.css` (motion tokens/utilities)

### Acceptance Criteria (Feature 2)

- Interactive controls have consistent, subtle motion feedback.
- Motion is disabled or simplified when reduced-motion is enabled.
- Performance remains smooth on mobile and low-power devices.
- No safety-critical UX regressions in admin/public flows.
- Display language switching transitions animate without harming readability (word-level wrapping retained in translated text).

---

## Delivery Plan

### Phase 1: Theme Architecture + Hi-viz Foundation (Completed - February 11, 2026)

- Added contrast mode infrastructure and persistence.
- Implemented menu changes + icon labels.
- Introduced high-contrast tokens and scope classes.
- Validated all pages in light/dark/system/hi-viz combinations.

### Phase 2: Motion Foundation (Completed - February 11, 2026)

- Installed `motion` dependency and configured Animate UI registry in `components.json`.
- Installed animated icon components via shadcn CLI: Sun, Moon, SunMoon, Search (Eye and Languages not available as animated variants).
- Added motion design tokens (`--duration-fast/normal/slow`, `--ease-default/spring`) to `@theme inline` in `globals.css`.
- Added global `prefers-reduced-motion: reduce` guard that disables all animations/transitions.
- Replaced theme-switcher dropdown menu icons (Sun, Moon, SunMoon) with animated variants using `animateOnHover`.
- Replaced public display search button icon with animated Search using `animateOnTap`.
- Preserved existing CSS-based Sun/Moon swap transition on theme trigger button.
- Added `IntersectionObserver` polyfill to `vitest.setup.ts` for jsdom compatibility with motion library.
- All 112 tests passing, build clean.

### Phase 3: Motion Expansion + Hardening (Completed - February 11, 2026)

- Added CSS keyframes and utility classes (`animate-fade-in`, `animate-slide-in-up`, `animate-pulse-subtle`) using motion tokens.
- Public display: staggered fade-in on ticket grid cells (capped at 50 cells / 1s max).
- Public display: Now Serving transition migrated from `AnimatePresence` + `motion.p` to Animate UI `MorphingText`.
- Public display: info cards (Date, Tickets Issued, Total Tickets) slide-up entrance with stagger.
- Admin: pending action badge pulses subtly while action is in-flight.
- Admin: Live State badges (Next Up, Returned, Unclaimed) fade-in with stagger.
- All animations respect `prefers-reduced-motion` via global guard.
- All 112 tests passing, build clean.

### Phase 4: Animate UI Template Parity Audit (Completed - February 11, 2026)

Source reviewed for parity baseline:

- `https://www.shadcn.io/template/animate-ui-animate-ui` (template entrypoint).
- Template `View Code` repository (`imskyleen/animate-ui`) demo + primitive sources.
- Relevant demo families reviewed against this codebase:
  - `primitives/buttons/*` (Button, Flip, Liquid, Ripple)
  - `primitives/animate/tabs`
  - `icons/*` (including trigger/animation usage docs)
  - shadcn wrapper components used by this app (`button`, `dropdown-menu`, `popover`, `tabs`)

Parity inventory (app-relevant UI elements only):

| UI element | Template/demo sequence | Repo status before parity pass | Parity action | Final status |
|---|---|---|---|---|
| Shared motion button primitive (`src/components/animate-ui/primitives/buttons/button.tsx`) | Hover scale + tap scale on both native button and `asChild` via motion-capable slot | `asChild` branch bypassed motion sequence | Switched to animate `Slot` path with the same hover/tap sequence and preserved reduced-motion guard | Parity achieved |
| Animated tabs primitive (`src/components/animate-ui/primitives/animate/tabs.tsx`) | Spring highlight, horizontal panel track slide, auto-height container motion, trigger tap-scale, inactive blur | Highlight + blur present, but no auto-height and no trigger tap sequence | Added auto-height measurement/animation, track slide parity, and trigger tap-scale sequence | Parity achieved |
| Login tab usage (`src/app/login/page.tsx`) | Demo structure: `TabsHighlight` + `TabsContents` + `TabsContent` with horizontal motion | Initially vertical fade behavior; then partial parity | Wired to updated primitive sequence and retained blur/glass highlight treatment | Parity achieved |
| Animated icons used in app (`Sun`, `Moon`, `SunMoon`, `Search`) | Trigger-driven icon animations (`animateOnHover`, `animateOnTap`) | Matches demo API and sequence usage where variants exist | No change needed beyond previous fixes | Parity maintained |
| Theme/language glyphs without Animate UI variants (`Eye`, `Languages`) | No upstream animated equivalents | Static Lucide icons in those slots | Kept as explicit exception; motion provided by surrounding button interactions | Exception documented |

Out-of-scope demos (not currently used by this product UI): Avatar Group, Cursor, Code Block, Motion Grid, Pinned List, Scroll Progress, Github Stars, text effects, and non-adopted button variants (Flip/Liquid/Ripple).

### Phase 5: Display Text Morph + Localization Readability (Completed - February 12, 2026)

- Tuned public display "Now Serving" `MorphingText` to bottom-up insert/sweep with one-character-at-a-time sequencing.
- Added a shared `LanguageMorphText` wrapper and applied it across display translated labels/messages (including ticket detail + ticket-not-found dialogs).
- Added word-aware wrapping to the morph primitive (`wordWrap="word"` path) and made language text default to word wrapping to prevent orphan characters in localized headings.
- Kept polling status text static to avoid repeated re-animation every refresh cycle.
- Lint/test/build remain green after integration.

---

## Testing Plan

### Functional

- Theme selection persists and restores correctly.
- System mode correctly tracks OS dark/light.
- Hi-viz applies correct token set in light/dark environments.
- Existing admin actions (generate/append/serving/reset/history) behave unchanged.

### Accessibility

- Keyboard-only navigation for switchers and dialogs.
- Screen-reader labels for all new controls/icons.
- Contrast checks across core screens and status states.
- Reduced-motion behavior validation.

### Performance

- Compare interaction responsiveness before/after motion integration.
- Verify no visible jank on touch devices.
- Validate that polling/display cadence behavior is unaffected.

---

## Risks and Mitigations

- **Risk:** Theme complexity increases with two-axis state.  
  **Mitigation:** Keep clear separation between color-scheme and contrast mode, with explicit persistence keys.

- **Risk:** Animate UI icon API changes (beta).  
  **Mitigation:** Introduce a local wrapper layer for animated icons to isolate future API churn.

- **Risk:** Motion reduces clarity in high-stress workflows.  
  **Mitigation:** Constrain motion to short, purposeful transitions and disable where task critical.

- **Risk:** Contrast regressions in custom gradient/status tokens.  
  **Mitigation:** Validate token pairs directly and fallback to solid high-contrast alternatives where needed.

---

## Definition of Done (v1.4.0)

- Hi-viz theme shipped and stable with system default behavior preserved.
- Theme menu shows Light/Dark/System/Hi-viz with Lucide icons.
- Motion enhancements shipped for targeted interactions with reduced-motion support.
- No regressions in safety-critical queue workflows.
- Docs updated to reflect final implementation details and usage guidance.
