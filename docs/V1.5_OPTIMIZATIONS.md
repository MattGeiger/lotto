# v1.5 Animation Optimization Plan

**Status:** Draft  
**Target branch:** `dev`  
**Scope:** Animation performance and low-spec support (no raffle/state-model changes)  
**Last updated:** February 13, 2026

---

## Summary

Version 1.5 focuses on improving animation smoothness on low-power clients (for example Raspberry Pi + Chromium) while preserving the existing visual language on stronger hardware.

This plan intentionally favors progressive degradation over removing motion entirely.

---

## Alignment With Existing Patterns

- **WITHIN existing patterns:** token-first UI, incremental component-level changes, no architecture rewrite.
- **WITHIN existing patterns:** maintain existing safety-critical UX behavior (queue clarity, no hidden state changes).
- **Constraint:** keep current rollout model (`CHANGELOG.md`, `ISSUES.md`, docs-first design notes).

---

## Current Observations

1. Animated blur was previously a major framerate cost and has now been removed from morph text paths.
2. 3D rolling text for numeric "Now Serving" is currently acceptable on Raspberry Pi targets and will remain unchanged for now.
3. Remaining hotspots are primarily per-character morphing work and concurrent icon/button/tab motion on lower-end hardware.

---

## Goals

1. Improve frame consistency for text transitions on low-spec clients.
2. Preserve readability and perceived responsiveness.
3. Keep motion style parity on higher-spec devices.
4. Introduce a clear fallback profile for constrained hardware.

## Non-Goals

1. No changes to raffle fairness, ticket ordering, or API semantics.
2. No redesign of the display/admin layout structure.
3. No immediate full telemetry platform integration.

---

## Optimization Strategy

### Phase 0 (Completed)

1. Remove animated blur from morph text transitions:
   - `src/components/animate-ui/primitives/texts/morphing.tsx`
   - `src/components/language-morph-text.tsx`
   - `src/components/readonly-display.tsx`

### Phase 1 (Planned): Low-Spec Animation Profile

Create a runtime animation profile with explicit tiers:

1. `full` (default on capable hardware)
2. `balanced` (reduced complexity)
3. `low` (minimal motion cost)

Profile selection inputs:

1. `prefers-reduced-motion`
2. `navigator.hardwareConcurrency`
3. `navigator.deviceMemory` (when available)
4. Optional URL/debug override for QA

### Phase 2 (Planned): Morph Workload Reduction

Primary experiment target:

1. Add morph render modes in `MorphingText`:
   - `character` (current behavior)
   - `whole` (single-node morph)
2. Use `whole` mode in low-spec profile.
3. Set `characterStagger=0` in balanced profile where full per-character sequencing is not critical.

Scope priority:

1. Display labels and language-switching text.
2. Large-format waiting-state morph text.
3. Modal/supporting copy using `LanguageMorphText`.

Note: RollingText 3D numeric transitions remain unchanged in this iteration.

### Phase 3 (Planned): Concurrent Motion Budget

1. Reduce simultaneous icon animation triggers (`animateOnView`/hover/tap) in low profile.
2. Disable button scale micro-interactions globally in low profile.
3. Keep critical feedback motion (state changes, active controls) while removing decorative overlap.

---

## Benchmarking Approach (Planned, Lightweight)

For controlled A/B testing (not full telemetry yet):

1. URL flags:
   - `?animPerf=1`
   - `?morphMode=character|whole`
2. Per-run metrics:
   - duration (ms)
   - frame count
   - average FPS
   - p95 frame time
   - dropped-frame estimate
   - long-task count/total via `PerformanceObserver`
3. Log targets:
   - `console.table`
   - in-memory global (`window`)
   - `localStorage` snapshot for export
4. QA test set:
   - Raspberry Pi 4 Chromium
   - Raspberry Pi 5 Chromium
   - baseline laptop (macOS/Windows) for parity checks

---

## Acceptance Criteria

1. Low-spec profile produces visibly smoother morph transitions than current full profile on Pi-class hardware.
2. No regressions in queue readability or key state comprehension.
3. High-spec clients preserve current motion feel unless user requests reduced motion.
4. Build/test baseline remains clean.

---

## Risks and Mitigations

1. Risk: visual inconsistency across devices.
   - Mitigation: profile-specific QA snapshots and parity review.
2. Risk: over-degrading motion in low profile.
   - Mitigation: keep clear hierarchy animations and validate readability with operators.
3. Risk: ad hoc performance tuning drift.
   - Mitigation: profile definitions documented and versioned in this plan + `CHANGELOG.md`.

---

## Initial Implementation Checklist

1. Add animation profile resolver utility + hook.
2. Add `mode` support (`character`/`whole`) to `MorphingText`.
3. Wire `LanguageMorphText` and display morph usage to profile.
4. Add optional benchmark flag mode for QA-only runs.
5. Document outcomes in `docs/ISSUES.md`, `CHANGELOG.md`, and `docs/RELEASES.md` when shipped.
